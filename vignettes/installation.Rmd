---
title: "Installation"
author: "Will Lowe"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Installation}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

## Getting Java

You want to install the 'JDK' for the latest version of the Java language.  As of 9 May 2015 the latest version of Java is called `Java SE 8u45`.  There are two steps:

 1. Press the big square button with a stylized coffee cup and the words 'Java' and 'Download' on [this page](http://www.oracle.com/technetwork/java/javase/downloads/index.html).

 2. You're now on a page entitled 'Java SE Development Kit 8 Downloads'.  Press the radio button marked 'Accept License Agreement' and click on the link associated with your operating system, and follow the instructions in the installer.

## Getting R to talk to Java

Now it's time to persuade R to talk to your new Java installation.  You can do this by

    install.packages('rJava')

If you're incredibly lucky, you're done.  In R, try typing

    library(rJava)

and if that works without complaint, check the version of Java that R sees by typing

    .jinit()
    .jnew("java/lang/System")$getProperty("java.specification.version")

It should say "1.8".  If it does not, probably because you're on a Mac, then you need to read about the 'Mac Kudgerama' below.

If it did work out then you can install rjca directly from Github.  

## Getting rjca

At your R prompt type

    install.packages('devtools') ## if you don't already have it
    devtools::install('conjugateprior/rjca')

Now have a look at the introductory vignette to see what you can do with it

    vignette('introduction', package='rjca')

## Mac Kludgerama

The following is a variant of Andrew Goldstone's [cunning workaround](http://andrewgoldstone.com/blog/2015/02/03/rjava/). I shall assume you want to use RStudio, but if you'd prefer to use the GUI that comes with R, then just replace every mention of `RStudio` with `R` in the instructions.  

There are four steps:

 1. Install a hopelessly out of date Java from Apple.  You may already have been prompted to 'install a virtual machine' during the process above.  If you did that already, great.  If you didn't, here's the link: [http://support.apple.com/kb/DL1572](http://support.apple.com/kb/DL1572).
Press the blue button there to download the installer, and run it.  
    
 2. Re-install the rJava package from source.  At an R prompt, type     
    
        install.packages("rJava", type='source')
  
 3. Make a Desktop link to launch RStudio. To do this, open a Terminal window (you'll find the Terminal in the Utilities folder inside your Applications folder) and paste the following two lines into it
 
          touch ~/Desktop/LaunchRStudio.command
          open -e ~/Desktop/LaunchRStudio.command
 
    The second will open a TextEdit window.  Into that window paste the the following three line incantation
 
         JVER=`java -version 2>&1 | head -n 1 | cut -d'"' -f 2`
         DYLD_FALLBACK_LIBRARY_PATH=/Library/Java/JavaVirtualMachines/jdk${JVER}.jdk/Contents/Home/jre/lib/server/
         export DYLD_FALLBACK_LIBRARY_PATH 
         open -a RStudio # replace with R if you'd prefer

     save the file, and close the TextEdit window.  

 4. Back in that Terminal window type

        chmod 755 ~/Desktop/LaunchRStudio.command
    
    and close that window too.  
 
Phew.  Now double-click the new file on the Desktop.  If all is well it will launch an RStudio window into which you can type 

    library(rjca)
    
without complaint.  

The RStudio that launches by clicking this Desktop thingy is just the same as the one that you get from the Applications folder except that we've set a library path that let's Java work properly.  So you can still launch RStudio the old way.

If you've been having trouble with the 'mallet' package. This should fix those problems too.





